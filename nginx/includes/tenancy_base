include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
add_header Strict-Transport-Security "max-age=31536000" always; # managed by Certbot

access_log      /var/log/nginx/tenancy/access.log;
error_log       /var/log/nginx/tenancy/error.log;
rewrite_log     on;

root            /var/www/laravel/tenancy/public;
index           index.php;

location / {
    try_files   $uri $uri/ /index.php?$query_string;
}

# Remove trailing slash to please the routing system.
if (!-d $request_filename) {
    rewrite     ^/(.+)/$ /$1 permanent;
}

location ~* \.php$ {
    fastcgi_pass                    unix:/var/run/php/php7.2-fpm.sock;
    fastcgi_index                   index.php;
    fastcgi_split_path_info         ^(.+\.php)(.*)$;
    include                         /etc/nginx/fastcgi_params;
    fastcgi_param                   SCRIPT_FILENAME $document_root$fastcgi_script_name;
}

location ~ /\.ht {
    deny all;
}